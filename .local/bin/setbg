#!/bin/bash

# This script sets the background in swaywm so long as swaywm is setup to set
#	the background using a file in the path "~/.config/wallpaper.*"
#
# Works by copying the passed file to "~/.config/wallpapers" then symlinking
#	that file to "~/.config/wallpaper.{jpg,png}. 
#	Finally the user is notified of the change.

[ "$#" -ne "1" ] && printf "Incorrect usage."

# Check for valid image file
ext="$(printf $1 | tail -c 3)"
[ "$ext" = "png" ] || [ "$ext" = "jpg" ] || exit 1
[ -f "$1" ] || exit 2

# Should check if file is symbolic link before removing
rm ~/.config/wallpaper.* || echo "rm error"

ln -sf "$(pwd)/$1" "$HOME/.config/wallpaper.$ext" || echo "link error"
notify-send -i ~/.config/wallpaper.* "Wallpaper updated" "Please reload sway to complete changes. You can do so by pressing MOD+Shift+c."
